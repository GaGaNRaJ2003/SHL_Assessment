# Deployment Steps

## ✅ Completed
- [x] Code pushed to GitHub: https://github.com/GaGaNRaJ2003/SHL_Assessment
- [x] Project cleaned (irrelevant files removed)
- [x] .gitignore configured

## Next Steps: Deploy API and Frontend

### 1. Deploy API (Choose one platform)

#### Option A: Render.com (Recommended - Free tier available)
1. Go to https://render.com
2. Sign up/Login
3. Click "New +" → "Web Service"
4. Connect GitHub repository: `GaGaNRaJ2003/SHL_Assessment`
5. Configure:
   - **Name**: `shl-assessment-api`
   - **Environment**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `uvicorn src.api:app --host 0.0.0.0 --port $PORT`
6. Add Environment Variables:
   - `GEMINI_API_KEY`: Your Gemini API key
7. Click "Create Web Service"
8. Wait for deployment (5-10 minutes)
9. Copy the service URL (e.g., `https://shl-assessment-api.onrender.com`)

#### Option B: Railway.app
1. Go to https://railway.app
2. Sign up/Login with GitHub
3. Click "New Project" → "Deploy from GitHub repo"
4. Select `GaGaNRaJ2003/SHL_Assessment`
5. Add Environment Variable: `GEMINI_API_KEY`
6. Set start command: `uvicorn src.api:app --host 0.0.0.0 --port $PORT`
7. Deploy

### 2. Deploy Frontend (Streamlit Cloud)

1. Go to https://share.streamlit.io
2. Sign in with GitHub
3. Click "New app"
4. Select repository: `GaGaNRaJ2003/SHL_Assessment`
5. Main file path: `app/streamlit_app.py`
6. Add Environment Variable:
   - `API_URL`: Your deployed API URL (from step 1)
   - `GEMINI_API_KEY`: Your Gemini API key (if needed)
7. Click "Deploy!"
8. Wait for deployment
9. Copy the app URL (e.g., `https://shl-assessment.streamlit.app`)

### 3. Generate Embeddings (Important!)

**Before the API can work, you need to generate embeddings:**

1. SSH into your API deployment or run locally:
   ```bash
   # If running locally:
   python src/crawler.py  # Crawl assessments (if not done)
   python src/embeddings.py  # Generate embeddings
   ```

2. **For Render/Railway**: You may need to:
   - Add a one-time setup script that generates embeddings on first deploy
   - Or manually run embeddings generation and upload the generated files

**Alternative**: Create a setup endpoint that generates embeddings on first API call (with caching).

### 4. Test Deployment

1. **Test API Health**:
   ```bash
   curl https://your-api-url.com/health
   ```
   Should return: `{"status":"healthy"}`

2. **Test API Recommendation**:
   ```bash
   curl -X POST https://your-api-url.com/recommend \
     -H "Content-Type: application/json" \
     -d '{"query": "Java developer assessment"}'
   ```

3. **Test Frontend**: Open your Streamlit app URL and try a query

## Submission Checklist

Once deployed, you'll have:

1. ✅ **API Endpoint URL**: `https://your-api-url.com`
2. ✅ **GitHub Code URL**: `https://github.com/GaGaNRaJ2003/SHL_Assessment`
3. ✅ **Web Application Frontend URL**: `https://your-app.streamlit.app`
4. ✅ **2-Page Document**: `submission/approach_documentation.tex` (compile to PDF)
5. ✅ **CSV File**: `submission/predictions.csv`

## Important Notes

- **Embeddings**: The API needs `data/faiss_index.bin` and `data/faiss_metadata.pkl` to work. These are generated by `src/embeddings.py` and are currently in `.gitignore`. You may need to:
  - Generate them locally and commit them, OR
  - Add a setup script that generates them on first deploy

- **Model File**: XGBoost model (`data/xgboost_reranker.pkl`) is also needed. It can be regenerated by running `evaluate_xgboost.py` or training script.

## Quick Fix: Add Embeddings Generation to Deployment

You can modify `src/api.py` to auto-generate embeddings if they don't exist:

```python
# At the start of recommend_assessments function:
if not os.path.exists('data/faiss_index.bin'):
    from src.embeddings import initialize_vector_db
    initialize_vector_db(force_rebuild=True)
```

